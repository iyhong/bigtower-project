<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="GoHospitalizationSurgery">
<!-- 수술 목록 출력 -->
 	<select id="goSurgeryList" resultType="com.team4.project.government.hopitalizationSurgery.domain.GoSurgery" parameterType="Map">
	SELECT
		go_surgery_result.GO_SURGERY_RESULT_CODE,
		go_hospital.GO_HOSPITAL_NAME,
		go_surgery.GO_SURGERY_NAME,
		go_doctor.GO_DOCTOR_NAME,
		go_citizen.GO_CITIZEN_NAME,
		go_surgery_result.GO_SURGERY_RESULT_GO_REGISTRATION_DATE
	from go_surgery_result
	join go_surgery
		ON go_surgery_result.GO_SURGERY_CODE = go_surgery.GO_SURGERY_CODE
	join go_treat
		ON go_surgery_result.GO_TREAT_CODE = go_treat.GO_TREAT_CODE
	join go_hospital
		ON go_treat.GO_HOSPITAL_ID = go_hospital.GO_HOSPITAL_ID
	join go_doctor
		ON go_treat.GO_DOCTOR_ID = go_doctor.GO_DOCTOR_ID	
	join go_citizen
		on go_treat.GO_CITIZEN_NO = go_citizen.GO_CITIZEN_NO
	<where>
		<if test="firstDate != '' and secondDate != '' ">
			GO_SURGERY_RESULT_GO_REGISTRATION_DATE between #{firstDate} and #{secondDate}
		</if>
		<if test="searchContents!=''">
			AND GO_HOSPITAL_NAME=#{searchContents}
		</if>		
	</where>
	ORDER BY GO_SURGERY_RESULT_GO_REGISTRATION_DATE DESC
 	
 	</select>
 	<!-- 입퇴원 목록 -->
 	<select id="goHospitalizationList" resultType="com.team4.project.government.hopitalizationSurgery.domain.GoHospitalization">
		select
			go_hospitalization.GO_HOSPITALIZATION_CODE,
			go_hospital.GO_HOSPITAL_NAME,
			go_hospitalization.GO_HOSPITALIZATION_ENTER_DATE,
			go_hospitalization.GO_HOSPITALIZATION_EXIT_DATE,
			go_hospitalization.GO_TREAT_CODE
		from go_hospitalization
		join go_treat
			ON go_treat.GO_TREAT_CODE=go_hospitalization.GO_TREAT_CODE
		join go_hospital
			ON go_hospital.GO_HOSPITAL_ID = go_treat.GO_HOSPITAL_ID
		<where> 
			<choose>
				<when test="selectBox.equals('goHospitalName')">
					GO_HOSPITAL_NAME=#{searchContents}
				</when>
				<when test="selectBox.equals('goHospitalizationExitDate')">
					GO_HOSPITALIZATION_EXIT_DATE between #{firstDay} and #{toDay}
				</when>
			</choose>
		</where>
		ORDER BY GO_HOSPITALIZATION_ENTER_DATE DESC
 	
 	</select>
 	<!-- 진료로 통해서 질병 통합 -->
 	<select id="goDiagnosis" resultType="com.team4.project.government.diagnosisPrescription.domain.GoDiagnosis" parameterType="String">
 		SELECT
 			go_diagnosis.GO_DIAGNOSIS_CODE,
 			go_disease.GO_DISEASE_KOR
 		FROM go_diagnosis
 		JOIN go_disease
 			ON go_diagnosis.GO_DISEASE_CODE = go_disease.GO_DISEASE_CODE
 		WHERE GO_TREAT_CODE = #{goTreatCode}
 	
 	</select>
</mapper>
